<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firewall Builder</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        h1, h2 {
            text-align: center;
            color: #444;
        }
        form {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        form label {
            display: block;
            margin: 10px 0 5px;
        }
        form input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        form .error {
            color: red;
            font-size: 14px;
            margin-top: -8px;
            margin-bottom: 10px;
        }
        button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            margin-bottom: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ccc;
        }
        th {
            background: #007BFF;
            color: white;
        }
        #search-bar {
            margin-bottom: 20px;
            padding: 8px;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .pagination {
            text-align: center;
            margin-top: 20px;
        }
        .pagination button {
            margin: 0 5px;
            padding: 5px 10px;
            background: #007BFF;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .pagination button.active {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Firewall Builder</h1>

    <!-- Add Rule Form -->
    <form id="add-rule-form">
        <h2>Add New Rule</h2>
        <label for="direction">Direction:</label>
        <input type="text" id="direction" name="direction" placeholder="e.g., IN/OUT" required>
        <div id="direction-error" class="error"></div>

        <label for="protocol">Protocol:</label>
        <input type="text" id="protocol" name="protocol" placeholder="e.g., TCP/UDP" required>
        <div id="protocol-error" class="error"></div>

        <label for="source_ip">Source IP:</label>
        <input type="text" id="source_ip" name="source_ip" placeholder="e.g., 192.168.1.1">
        <div id="source_ip-error" class="error"></div>

        <label for="source_port">Source Port:</label>
        <input type="text" id="source_port" name="source_port" placeholder="e.g., 80">
        <div id="source_port-error" class="error"></div>

        <label for="destination_ip">Destination IP:</label>
        <input type="text" id="destination_ip" name="destination_ip" placeholder="e.g., 10.0.0.1">
        <div id="destination_ip-error" class="error"></div>

        <label for="destination_port">Destination Port:</label>
        <input type="text" id="destination_port" name="destination_port" placeholder="e.g., 443">
        <div id="destination_port-error" class="error"></div>

        <button type="submit">Add Rule</button>
    </form>

    <!-- Search Bar -->
    <input type="text" id="search-bar" placeholder="Search rules by protocol, IP, or port...">

    <!-- Existing Rules Table -->
    <h2>Existing Firewall Rules</h2>
    <table id="rules-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Direction</th>
                <th>Protocol</th>
                <th>Source IP</th>
                <th>Source Port</th>
                <th>Destination IP</th>
                <th>Destination Port</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for rule in rules %}
            <tr id="rule-{{ rule.id }}">
                <td>{{ rule.id }}</td>
                <td>{{ rule.direction }}</td>
                <td>{{ rule.protocol }}</td>
                <td>{{ rule.source_ip }}</td>
                <td>{{ rule.source_port }}</td>
                <td>{{ rule.destination_ip }}</td>
                <td>{{ rule.destination_port }}</td>
                <td>
                    <button class="delete-rule-btn" data-id="{{ rule.id }}">Delete</button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="pagination" id="pagination"></div>

    <!-- JavaScript -->
    <script>
        const addForm = document.getElementById('add-rule-form');
        const rulesTable = document.getElementById('rules-table').querySelector('tbody');
        const searchBar = document.getElementById('search-bar');
        const pagination = document.getElementById('pagination');

        // Validate form inputs in real-time
        function validateInput(input, errorElement, regex, message) {
            if (input.value && !regex.test(input.value)) {
                errorElement.textContent = message;
                return false;
            }
            errorElement.textContent = '';
            return true;
        }

        function validateForm() {
            const ipRegex = /^((25[0-5]|2[0-4][0-9]|[0-1]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[0-1]?[0-9][0-9]?)$/;
            const portRegex = /^[0-9]{1,5}$/;

            const sourceIpValid = validateInput(source_ip, source_ip_error, ipRegex, 'Invalid IP address.');
            const destinationIpValid = validateInput(destination_ip, destination_ip_error, ipRegex, 'Invalid IP address.');
            const sourcePortValid = validateInput(source_port, source_port_error, portRegex, 'Invalid port number.');
            const destinationPortValid = validateInput(destination_port, destination_port_error, portRegex, 'Invalid port number.');

            return sourceIpValid && destinationIpValid && sourcePortValid && destinationPortValid;
        }

        // Add Rule
        addForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!validateForm()) return;

            // Logic for adding rule (send request and update UI)
        });

        // Search Rules
        searchBar.addEventListener('input', () => {
            const query = searchBar.value.toLowerCase();
            [...rulesTable.rows].forEach(row => {
                const match = [...row.cells].some(cell => cell.textContent.toLowerCase().includes(query));
                row.style.display = match ? '' : 'none';
            });
        });

        // Pagination Logic (Placeholder)
        function setupPagination() {
            // Logic for paginating rules table (split rows into pages)
        }

        setupPagination();
    </script>
</body>
</html>
